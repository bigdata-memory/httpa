<!DOCTYPE html>
<!-- saved from url=(0070)https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html -->
<html lang="en" class="Internet-Draft"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Hypertext Transfer Protocol Attestable (HTTPA) Version 2</title>
<meta content="Shih-han Wang" name="author">
<meta content="Gordon King" name="author">
<meta content="Nick Li" name="author">
<meta content="Ned Smith" name="author">
<meta content="Krzysztof Sandowicz" name="author">
<meta content="
       
       
       
       The Hypertext Transfer Protocol Attestable version 2 (HTTPA/2) is an
      HTTP extension. It is a transaction-based protocol agnostic to Transport
      Layer Security (TLS) in which the Trusted Execution Environment (TEE) is
      considered a new type of requested resource over the Internet. The
      original Hypertext Transfer Protocol Attestable (HTTPA) (referred to as
      HTTPA/1 in the rest of the document) includes remote attestation (RA)
      process onto the HTTPS protocol in the assumption of using Transport
      Layer Security (TLS) across the Internet. In contrast, the design of
      HTTPA/2 could establish a trusted (attested) and more secure
      communication without dependence on TLS. 
       The definition of Attestation for the purposes of this draft: 
       The process of vouching for the accuracy of TEE based services,
      configuration, and data where the TEE conveys Evidence about its
      environment, roots of trust and protected functions.
      The Evidence is a digital expression of TEE trustworthiness. 
       
    " name="description">
<meta content="xml2rfc 3.18.2" name="generator">
<meta content="draft-sandowicz-httpbis-httpa2-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.9.16
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 3.11.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 58.1.0
    six 1.16.0
    wcwidth 0.2.8
    weasyprint 60.1
-->
<link href="https://www.ietf.org/a/www/www6s/staging/draft-sandowicz-httpbis-httpa2-03.xml" rel="alternate" type="application/rfc+xml">
<link href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="./draft-sandowicz-httpbis-httpa2-03_files/rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="./draft-sandowicz-httpbis-httpa2-03_files/metadata.min.js.download"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">HTTPA/2</td>
<td class="right">November 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wang, et al.</td>
<td class="center">Expires 7 May 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-sandowicz-httpbis-httpa2</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-11-04" class="published">4 November 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-05-07">7 May 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Wang</div>
<div class="org">Intel</div>
</div>
<div class="author">
      <div class="author-name">G. King</div>
<div class="org">Intel</div>
</div>
<div class="author">
      <div class="author-name">N. Li</div>
<div class="org">Intel</div>
</div>
<div class="author">
      <div class="author-name">N. Smith</div>
<div class="org">Intel</div>
</div>
<div class="author">
      <div class="author-name">K. Sandowicz</div>
<div class="org">Intel</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Hypertext Transfer Protocol Attestable (HTTPA) Version 2</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1"></p>
<p id="section-abstract-2"></p>
<p id="section-abstract-3"></p>
<p id="section-abstract-4">The Hypertext Transfer Protocol Attestable version 2 (HTTPA/2) is an
      HTTP extension. It is a transaction-based protocol agnostic to Transport
      Layer Security (TLS) in which the Trusted Execution Environment (TEE) is
      considered a new type of requested resource over the Internet. The
      original Hypertext Transfer Protocol Attestable (HTTPA) (referred to as
      HTTPA/1 in the rest of the document) includes remote attestation (RA)
      process onto the HTTPS protocol in the assumption of using Transport
      Layer Security (TLS) across the Internet. In contrast, the design of
      HTTPA/2 could establish a trusted (attested) and more secure
      communication without dependence on TLS.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-abstract-4" class="pilcrow">¶</a></p>
<p id="section-abstract-5">The definition of Attestation for the purposes of this draft:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-abstract-5" class="pilcrow">¶</a></p>
<p id="section-abstract-6">The process of vouching for the accuracy of TEE based services,
      configuration, and data where the TEE conveys Evidence about its
      environment, roots of trust and protected functions.
      The Evidence is a digital expression of TEE trustworthiness.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-abstract-6" class="pilcrow">¶</a></p>
<p id="section-abstract-7"></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 7 May 2024.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1" class="auto internal xref">1</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1" class="auto internal xref">1.1</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-conventions-used-in-this-do" class="internal xref">Conventions Used in This Document</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2" class="auto internal xref">2</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-protocol-overview-and-proto" class="internal xref">Protocol Overview and protocol flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.1" class="auto internal xref">2.1</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-untrusted-request-utr" class="internal xref">Untrusted Request (UtR)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.2" class="auto internal xref">2.2</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-attest-request-atr" class="internal xref">Attest Request (AtR)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.3" class="auto internal xref">2.3</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-trusted-request-trr" class="internal xref">Trusted Request (TrR)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.4" class="auto internal xref">2.4</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-protocol-flow" class="internal xref">Protocol flow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3" class="auto internal xref">3</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-protocol-transactions" class="internal xref">Protocol Transactions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1" class="auto internal xref">3.1</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-preflight-check-phase" class="internal xref">Preflight Check Phase</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2" class="auto internal xref">3.2</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-attest-handshake-aths-phase" class="internal xref">Attest Handshake (AtHS) Phase</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3" class="auto internal xref">3.3</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-attest-secret-provisioning-" class="internal xref">Attest Secret Provisioning (AtSP) Phase</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4" class="auto internal xref">3.4</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-trusted-phase-communication" class="internal xref">Trusted Phase Communication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.5" class="auto internal xref">3.5</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-changes-in-mutual-httpa-2mh" class="internal xref">Changes in Mutual HTTPA/2(mHTTPA)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4" class="auto internal xref">4</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.1" class="auto internal xref">4.1</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-layer-7-end-to-end-protecti" class="internal xref">Layer 7 End-to-End Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.2" class="auto internal xref">4.2</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-replay-protection" class="internal xref">Replay Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.3" class="auto internal xref">4.3</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-downgrade-protection" class="internal xref">Downgrade Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.4" class="auto internal xref">4.4</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.5" class="auto internal xref">4.5</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-roots-of-trust-rot" class="internal xref">Roots of Trust (RoT)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-5" class="auto internal xref">5</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-6" class="auto internal xref">6</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-7" class="auto internal xref">7</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-7.1" class="auto internal xref">7.1</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-7.2" class="auto internal xref">7.2</a>.&nbsp;&nbsp;<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#appendix-A" class="auto internal xref"></a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="n-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1" class="section-number selfRef">1. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"></p>
<p id="section-1-2">The HTTPA/1 <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#I-D-11" class="cite xref">I-D-11</a>]</span> defines an HTTP extension to handle requests for
      remote attestation, secret provisioning, and private data transmission,
      so internet visitors can access a wide variety of services running in
      Trusted Execution Environments (TEEs) to handle their requests with
      strong assurances.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The HTTPA/1 supports mutual attestation if both client and service
      endpoints run inside the TEE. Although HTTPA/1 helps build trust between
      L7 endpoints with data-level protection, HTTPA/1 needs TLS to defend
      against some specific attacks over the Internet, e.g., replay attacks
      and downgrade attacks, these attacks are not vulnerable in HTTP/2 due to
      specific improvements for them. Note that TLS cannot guarantee
      end-to-end security for the HTTPS message exchange <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#I-D-1" class="cite xref">I-D-1</a>]</span> when the
      TEE-based services (TServices) are hosted behind a TLS termination
      gateway or inspection appliance (a.k.a. middle boxes). Although the TLS
      can provide Confidentiality, Integrity, and Authenticity (ConfIntAuth)
      to help ensure the security of message exchange for HTTPA/1 protocol, it
      is not a complete end-to-end solution for web services at L7. Both
      HTTPA/1 and TLS need to generate key material through key exchange and
      derivation processes. This requires additional round trips at L5 and
      increases network latency. Thus, there is room to optimize the network
      performance further and reduce the communication complexity by avoiding
      the repetition of key negotiation. Due to the limitation of TLS
      mentioned above, a version of HTTPA with message-level security
      protection is a natural candidate to address the issues mentioned above.
      This document proposes an upgrade protocol, HTTPA/2, which makes it
      possible to secure HTTPA transactions without dependence on TLS. The
      HTTPA/2 is designed to improve the processes of key exchange, RA, and
      secret provisioning. It also enables end-to-end secure and trustworthy
      request/response transactions at L7, which is cryptographically bound to
      an attestable service base that can be trusted by internet visitors
      regardless of the presence of untrusted TLS termination.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The protocol described in this document focuses on extending the
      functionality provided by the HTTPA/1 protocol message formats. This
      document alone is sufficient to understand the protocol, and the HTTPA/1
      <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#I-D-11" class="cite xref">I-D-11</a>]</span> could be used as supplemental material.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"></p>
<div id="n-conventions-used-in-this-document">
<section id="section-1.1">
        <h3 id="name-conventions-used-in-this-do">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1" class="section-number selfRef">1.1. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-conventions-used-in-this-do" class="section-name selfRef">Conventions Used in This Document</a>
        </h3>
<p id="section-1.1-1"></p>
<p id="section-1.1-2">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
        "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
        "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and
        "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
        described in [BCP 14], [RFC 2119], [KEYWORDS].<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3"></p>
<p id="section-1.1-4">In addition to those listed above, this document uses the following
        terms:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">Trusted Execution Environment (TEE):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">TEE is an environment where genuine codes are executed on data with
        isolation and memory encryption inaccessible to anyone.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7"></p>
<p id="section-1.1-8">Rich Execution Environment (REE):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9">In contrast to TEE, codes are executed on data without
        isolation.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1-10"></p>
<p id="section-1.1-11">Client:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-11" class="pilcrow">¶</a></p>
<p id="section-1.1-12">The endpoint initiating the HTTPA connection.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-12" class="pilcrow">¶</a></p>
<p id="section-1.1-13"></p>
<p id="section-1.1-14">Server:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-14" class="pilcrow">¶</a></p>
<p id="section-1.1-15">The endpoint did not initiate the HTTPA connection. In HTTPA/2, it
        refers to TEE-based Service (TService) running inside an enclave.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-15" class="pilcrow">¶</a></p>
<p id="section-1.1-16"></p>
<p id="section-1.1-17">Client-side verifier(c-verifier):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-17" class="pilcrow">¶</a></p>
<p id="section-1.1-18">Verifier from the client side.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-18" class="pilcrow">¶</a></p>
<p id="section-1.1-19"></p>
<p id="section-1.1-20">Server-side verifier(s-verifier):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-20" class="pilcrow">¶</a></p>
<p id="section-1.1-21">Verifier from the server side.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-21" class="pilcrow">¶</a></p>
<p id="section-1.1-22">Attestation:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-22" class="pilcrow">¶</a></p>
<p id="section-1.1-23">Attestation is the process of demonstrating that a software
        executable has been properly instantiated on a platform, thus
        establishing a level of confidence in the trustworthiness of a remote
        peer.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-23" class="pilcrow">¶</a></p>
<p id="section-1.1-24"></p>
<p id="section-1.1-25">Attest Quote(AtQ):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-25" class="pilcrow">¶</a></p>
<p id="section-1.1-26">AtQ is an opaque data structure signed by a Quoting Service
        (QService) with an attestation key (AK). It can be called a quote or
        attestation evidence, which is used to establish trustworthiness
        through identities.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-26" class="pilcrow">¶</a></p>
<p id="section-1.1-27"></p>
<p id="section-1.1-28">Attest Base(AtB):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-28" class="pilcrow">¶</a></p>
<p id="section-1.1-29">AtB is the totality of computing resources serving client request
        handling, including hardware, firmware, software, and access controls
        to work together to deliver trustworthy service quality with enforced
        security/privacy policy.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-29" class="pilcrow">¶</a></p>
<p id="section-1.1-30"></p>
<p id="section-1.1-31">Attest header line(AHL)<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-31" class="pilcrow">¶</a></p>
<p id="section-1.1-32">It refers to the different types of header lines used during the
        handshake phase, including Attest Ticket, Attest Binder, etc.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-32" class="pilcrow">¶</a></p>
<p id="section-1.1-33"></p>
<p id="section-1.1-34">Attest header Field(AHF)<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-34" class="pilcrow">¶</a></p>
<p id="section-1.1-35">Regarding the HTTP method, we propose a new HTTP method, called
        "ATTEST," to perform the transactions of AtHS and AtSP. The HTTP
        request using ATTEST method is called AtR. Regarding HTTP header
        fields, we propose to augment them with additional ones called Attest
        Header Fields (AHFs) prefixed with the string "Attest-." Without AHFs,
        it must be a UtR in terms of HTTPA/2.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-35" class="pilcrow">¶</a></p>
<p id="section-1.1-36"></p>
<p id="section-1.1-37">Attest Ticket(AtT):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-37" class="pilcrow">¶</a></p>
<p id="section-1.1-38">AtT is a type of attest header line(AHL) used to ensure the
        integrity and authenticity (IntAuth) of AHLs and freshness are
        protected cryptographically, except for the AtR of AtHS, the
        initiating request for the handshake.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-38" class="pilcrow">¶</a></p>
<p id="section-1.1-39"></p>
<p id="section-1.1-40">Attest Binder (AtBr):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-40" class="pilcrow">¶</a></p>
<p id="section-1.1-41">AtBr is a type of AHL used to ensure the binding between the
        HTTPA/2 request and the corresponding response.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-41" class="pilcrow">¶</a></p>
<p id="section-1.1-42"></p>
<p id="section-1.1-43">Attest Request (AtR)<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-43" class="pilcrow">¶</a></p>
<p id="section-1.1-44">Regarding the HTTP method, we propose a new HTTP method, called
        "ATTEST," to perform the transactions of Attest Handshake(AtHS) and
        Attest Secret Provisioning (AtSP). The HTTP request using ATTEST
        method is called AtR.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-44" class="pilcrow">¶</a></p>
<p id="section-1.1-45"></p>
<p id="section-1.1-46">Trusted Computing Base(TCB):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-46" class="pilcrow">¶</a></p>
<p id="section-1.1-47">The minimal totality of hardware, software, or firmware must be
        trusted for security requirements.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-47" class="pilcrow">¶</a></p>
<p id="section-1.1-48"></p>
<p id="section-1.1-49">Trusted Cargo(TrC):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-49" class="pilcrow">¶</a></p>
<p id="section-1.1-50">TrC is a vehicle to carry confidential information which needs to
        be protected by authenticated encryption. It can appear in both
        HTTPA/2 request and response messages, except for the AtR of AtHS.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-50" class="pilcrow">¶</a></p>
<p id="section-1.1-51"></p>
<p id="section-1.1-52">Trusted Transport Layer Security(TrTLS):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-52" class="pilcrow">¶</a></p>
<p id="section-1.1-53">If users want to protect the entire HTTP message?every bit of the
        message, HTTPA/2 can leverage TLSto establish a secure connection at
        L5 between the client and its adjacent middle box, which we call
        TrTLS.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-53" class="pilcrow">¶</a></p>
<p id="section-1.1-54">Preflight<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-54" class="pilcrow">¶</a></p>
<p id="section-1.1-55">This is the first phase of the HTTPA/2 transactions, and it is a
        lightweight HTTP OPTIONS request.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-1.1-55" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-protocol-overview-and-protocol-flow">
<section id="section-2">
      <h2 id="name-protocol-overview-and-proto">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2" class="section-number selfRef">2. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-protocol-overview-and-proto" class="section-name selfRef">Protocol Overview and protocol flow</a>
      </h2>
<p id="section-2-1"></p>
<p id="section-2-2">There are three types of requests defined by the HTTPA/2 protocol,
      including Un-trusted Request (UtR), Attest Request (AtR), and Trusted
      Request (TrR). UtR is used in HTTP(S) transactions; AtR is used in both
      transactions of Attest Handshake (AtHS) and Attest Secret Provisioning
      (AtSP); TrR is used in the trusted transaction. For convenience, we
      refer to the AtR and TrR as "HTTPA/2 request". Regarding the HTTP
      method, we propose a new HTTP method, called "ATTEST," to perform the
      transactions of AtHS and AtSP. The HTTP request using ATTEST method is
      called AtR. Regarding HTTP header fields, we propose to augment them
      with additional ones called Attest Header Fields (AHFs) prefixed with
      the string "Attest-." Without AHFs, it must be a UtR in terms of
      HTTPA/2.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The AHFs are dedicated to HTTPA traffic. For example, they can be
      used to authenticate the identity of HTTPA/2 transactions source,
      indicate which AtB to request, convey confidential metadata, provision
      secrets, present ticket, etc.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The last one is AHL, and it consists of AHF and its values in a
      standard form <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#RFC8941" class="cite xref">RFC8941</a>]</span>. We use it to signify a single piece of
      annotated data associated with the current HTTPA/2 request.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5"></p>
<div id="n-untrusted-request-utr">
<section id="section-2.1">
        <h3 id="name-untrusted-request-utr">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.1" class="section-number selfRef">2.1. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-untrusted-request-utr" class="section-name selfRef">Untrusted Request (UtR)</a>
        </h3>
<p id="section-2.1-1"></p>
<p id="section-2.1-2">An untrusted request is for any transactions that are not
        sensitive. The UtR is simply an ordinary type of HTTP request, which
        does not use the ATTEST method nor contains any AHLs.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Before a UtR reaches a TService, the UtR can be easily eavesdropped
        on or tampered with along the communication path. Even protected by
        TLS, it can still be attacked when crossing any application gateway or
        L7 firewall since those intervening middle-boxes are untrusted and
        will terminate TLS connections hop by hop <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#I-D-1" class="cite xref">I-D-1</a>]</span>. Therefore, there is no
        guarantee of ConfIntAuth. That's why the TService cannot treat the
        request as trustworthy, but it is still possible for TService to
        handle UtR if allowed by the service-side policy. Thus, we don't
        suggest TService to handle any one of them for the sake of
        security.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4"></p>
</section>
</div>
<div id="n-attest-request-atr">
<section id="section-2.2">
        <h3 id="name-attest-request-atr">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.2" class="section-number selfRef">2.2. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-attest-request-atr" class="section-name selfRef">Attest Request (AtR)</a>
        </h3>
<p id="section-2.2-1"></p>
<p id="section-2.2-2">The AtR is a HTTP request equipped with both ATTEST method and AHLs
        for AtHS and AtSP. If the corresponding TService did not accept any
        AtR, subsequent TrR will no longer be valid to this TService. The
        major difference between an AtR used in AtHS and AtSP respectively is
        as follows:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">1)<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">The AtR used in AtHS is designed to request all necessary resources
        for handling both types of AtR used in AtSP and AtHS. For example, one
        of the most critical resources is AtB, which may be scheduled or
        allocated by a server-side resource arbiter. Typically (but not
        always), an upfront TService can directly designate itself as the AtB
        for this client.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">2)<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">The AtR of AtSP is optional in HTTPA/2 traffic flow since, in some
        cases, the TService does not need any AtB-wide secrets provided by the
        client to work. In the typical case, TService needs secret
        provisioning to configure its working environment, such as connecting
        to databases, setup signing keys and certificates, etc. This AtR must
        be issued after all TEE resources have been allocated through the AtHS
        transaction described above. It's worth noting that this request is
        not required to be issued before any TrR.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7"></p>
</section>
</div>
<div id="n-trusted-request-trr">
<section id="section-2.3">
        <h3 id="name-trusted-request-trr">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.3" class="section-number selfRef">2.3. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-trusted-request-trr" class="section-name selfRef">Trusted Request (TrR)</a>
        </h3>
<p id="section-2.3-1"></p>
<p id="section-2.3-2">The TrR can be issued right after a successful AtHS where an AtB is
        allocated. Although TrR does not use ATTEST method, it should contain
        AHLs to indicate that it is a TrR, not a UtR. In other words, the TrR
        is nothing but an ordinary HTTP request with some AHLs. Within those
        AHLs, one of them must be AtB ID to determine which AtB is targeted in
        addition to the specified URI. The TrR can be dispatched to the proper
        TService to handle this request.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3"></p>
</section>
</div>
<div id="n-protocol-flow">
<section id="section-2.4">
        <h3 id="name-protocol-flow">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.4" class="section-number selfRef">2.4. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-protocol-flow" class="section-name selfRef">Protocol flow</a>
        </h3>
<p id="section-2.4-1"></p>
<p id="section-2.4-2">As shown
      in Figure 1, we illustrate those
      transactions from a client perspective, including preflight, AtHS, AtSP,
      and trusted requests in a workflow diagram. A detailed explanation of
      each phase is in the following chapters. In the design of HTTPA/2, only
      the phase of AtHS is required. This largely simplifies the interaction
      between the client and the TService and improves the overall service
      experience for both security and remote attestation.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3"></p>
<p id="section-2.4-4"></p>
<span id="name-httpa-transaction-workflow-"></span><div id="ure-figure-1">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-2.4-5.1">
<pre>                                +-----+  +-------------+  no
                                |START|-&gt;|go preflight?|--------------+
                                +-----+  +-------------+              |
                                                | yes                 |
                                                v                     |
                                           +---------+                |
                                           |Preflight|                |
                                           +---------+                |
                                                |                     |
                                                v                     |
                                           +--------+  no  +----+     |
                                           |allowed?|-----&gt;|STOP|     |
                                           +--------+      +----+     |
                                            yes |                     |
                                                +---------------------+
                                                |
                                                v
                                           +---------+  yes
                                           |attested?|----------------+
                                           +---------+                |
                                                | no                  |
                                                v                     |
                                        +----------------+            |
                                        |Attest Handshake|            |
                                        +----------------+            |
                                                |                     |
                                                +---------------------+
                                                |                     |
                                                v                     |
                        +----+  invalid  +------------+               |
                        |STOP|----------&gt;|Attest base?|               |
                        +----+           +------------+               |
                                                | valid               |
                                                v                     |
               +-------------------------+--------------+             |
               |                         |              |             |
               v                         v              v             |
        +--------------+           +-----------+  +-----------+       |
        |need base-wide| no        |  Trusted  |  | Untrusted |       |
        |   secrets?   |--------+  |Transaction|  |Transaction|       |
        +--------------+        |  +-----------+  +-----------+       |
               |                |        |              |             |
               v                |        |              |             |
      +-------------------+     |        |              |             |
      |Secret Provisioning|     |        |              |             |
      +-------------------+     |        |              |             |
              |                 |        |              |             |
              v                 |        |              |             |
         +---------+ no +----+  |        |              |             |
         |accepted?|---&gt;|STOP|  |        |              |             |
         +---------+    +----+  |        |              |             |
              | yes             |        |              |             |
              v                 v        v              v             |
              +-----------------+--------+--------------+             |
                                  |                                   |
                                  v                                   |
             +----+    yes  +-----------+  no                         |
             |STOP|&lt;--------|terminated?|-----------------------------+
             +----+         +-----------+
</pre>
</div>
<figcaption><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#figure-1" class="selfRef">Figure 1</a>:
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-httpa-transaction-workflow-" class="selfRef">HTTPA transaction workflow from the client view</a>
          </figcaption></figure>
</div>
<p id="section-2.4-6">The Figure 2 shows the workflow, which can help understand how
      those transactions are distinguished in TService.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-2.4-6" class="pilcrow">¶</a></p>
<p id="section-2.4-7"></p>
<span id="name-httpa-transaction-workflow-f"></span><div id="ure-figure-2">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-2.4-8.1">
<pre>                                       +-----+
                                       |START|
                                       +--+--+
                                          |
                                          v
                                          +---------------------------+
                                          |                           |
                                          v                           |
                              yes  +------+--------+    no            |
                         +---------+ATTEST request?+--------------+   |
                         |         +---------------+              |   |
                         v                                        |   |
        contained  +-----+-+  not contained                       |   |
        +----------+base id+------------+                         |   |
        |          +-------+            |                         |   |
        v                               v                         |   |
+-------+-----------+          +--------+-------+                 |   |
|Secret Provisioning|          |Attest Handshake|                 |   |
+------+------------+          +---------+------+                 |   |
       |                                 |                        |   |
       v                                 v                        |   |
 +-----+---+  invalid  +----+        +---+-+  fail  +----+        |   |
 |base-wide+----------&gt;+STOP|        |base?+-------&gt;+STOP|        |   |
 |secrets? |           +----+        +--+--+        +----+        |   |
 +-----+---+                            |                         |   |
       | valid                          | allocated               |   |
       v                                v                         |   |
       ++-------------------------------+                         |   |
        |                                                         |   |
        |                            +----------------------------+   |
        |                            |                                |
        |                            v                                |
        |             contained  +---+---+  not contained             |
        |        +---------------+base id+-------------+              |
        |        |               +-------+             |              |
        |        v                                     v              |
        |  +-----+-------------+             yes  +---+----+  no      |
        |  |Trusted Transaction|            +-----+OPTIONS +----+     |
        |  +-----+-------------+            |     |request?|    |     |
        |        |                          |     +--------+    |     |
        |        v                          v                   v     |
        |  +-----+-----+  yes  +----+  +----+----+      +-------+---+ |
        |  |terminated?+------&gt;+STOP|  |Preflight|      | Untrusted | |
        |  +-----+-----+       +----+  +-----+---+      |Transaction| |
        |        |                           |          +---------+-+ |
        |        |                           v                    |   |
        |        | no                   +----+---+  no  +----+    |   |
        |        |                      |allowed?+-----&gt;+STOP|    |   |
        |        |                      +----+---+      +----+    |   |
        |        |                           | yes                |   |
        |        |                           v                    v   |
        |        |                           +------------+-------+   |
        |        |                                        |           |
        |        v                                        v           |
        |        +----------------------------------------+           |
        |                             |                               |
        v                             v                               |
        +-------------------+---------+                               |
                            |                                         |
                            v                                         |
       +----+    yes  +-----+-----+  no                               |
       |STOP+&lt;--------+terminated?+-----------------------------------+
       +----+         +-----------+
</pre>
</div>
<figcaption><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#figure-2" class="selfRef">Figure 2</a>:
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-httpa-transaction-workflow-f" class="selfRef">HTTPA transaction workflow from the TService view</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="n-protocol-transactions">
<section id="section-3">
      <h2 id="name-protocol-transactions">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3" class="section-number selfRef">3. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-protocol-transactions" class="section-name selfRef">Protocol Transactions</a>
      </h2>
<p id="section-3-1"></p>
<div id="n-preflight-check-phase">
<section id="section-3.1">
        <h3 id="name-preflight-check-phase">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1" class="section-number selfRef">3.1. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-preflight-check-phase" class="section-name selfRef">Preflight Check Phase</a>
        </h3>
<p id="section-3.1-1"></p>
<p id="section-3.1-2">The preflight request uses OPTIONS request to give the web service
        a chance to see what the actual AtR looks like before it is made, so
        the service can decide whether it is acceptable. In addition, the
        client endpoint performs the preflight check as a security measure to
        ensure that the visited service can understand the ATTEST method,
        AHFs, and its implied security assurance.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">To start HTTPA/2, a preflight request could be issued by a client
        as optional to check whether the Web service, specified by URI in the
        request line is TEE-aware and prepared for AtHS. If the client is a
        web browser, the preflight request can be automatically issued when
        the AtR qualifies as "to be preflighted." We need the preflight
        transaction because it is a lightweight HTTP OPTIONS <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#RFC7231" class="cite xref">RFC7231</a>]</span>
        request, which will not consume a lot of computing resources to handle
        compared to the AtR. Caching the preflight result can prevent
        re-checking during a specified time window. In the case of
        out-of-sync, the TService will result in an invalid signal for HTTPA
        trusted requests.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">Passing this check does not guarantee that this service can
        successfully handle the AtR. For example, the TService may run out of
        resources, or the client's cipher suites are not supported, and so
        on.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5"> The client can also use the preflight to detect the capabilities
        of AtB, without implying any actual actions.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6"></p>
<span id="name-message-flow-example-for-pr"></span><div id="ure-figure-3">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.1-7.1">
<pre>Client-side     Web Client        Web TService               Server-side
Verifier    (HW-TEE,Attester)  (HW-TEE,Attester)                Verifier
    |              |                 |                               |
    |              |checkAttestMethod|                               |
    |              |----------------&gt;|       Optional request:       |
    |              |                 | Access-Control-Request-Method |
    |              |                 |           ATTEST              |
    |              |                 | Access-Control-Request-Headers|
    |              |                 |           ATTEST-Base-id,     |
    |              |                 |           ATTEST-Ticket,      |
    |              |                 |           ATTEST-Signature..  |
    |              |                 |------------------------------&gt;|
    |           +===================PASS===============================+
    |           |  |                 |         HTTP 200 OK           | |
    |           |  |                 |         Allow: ATTEST         | |
    |           |  |                 | Access-Control-Allow-Headers: | |
    |           |  |                 |           ATTEST-Base-id,     | |
    |           |  |                 |           ATTEST-Ticket,      | |
    |           |  |                 |           ATTEST-Signature... | |
    |           |  |                 |&lt;------------------------------| |
    |           |  | HTTP 200 OK     |                               | |
    |           |  |&lt;----------------|                               | |
    |           +======================================================+
    |              |                 |                               |
    |           +=================FAILURE==============================+
    |           |  |                 |                               | |
    |           |  | HTTP 405 METHOD_NOT_ALLOWED                     | |
    |           |  |&lt;----------------|                               | |
    |           |  |                 |                               | |
    |           |  | showErrors      |                               | |
    |           |  |-------+         |                               | |
    |           |  |       |         |                               | |
    |           |  |&lt;------+         |                               | |
    |           +======================================================+
    |              |                 |                               |
</pre>
</div>
<figcaption><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#figure-3" class="selfRef">Figure 3</a>:
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-message-flow-example-for-pr" class="selfRef">Message Flow example for Preflight transaction</a>
          </figcaption></figure>
</div>
<p id="section-3.1-8">As shown in Figure 3, an
        OPTIONS request should be honored by an HTTPA/2 compliant TService.
        The preflight transaction has standard HFs to specify the method and
        AHLs which will be sent out later to the same TService<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">if they are acceptable. Those HFs are described respectively as
        follows:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">1. HFs in the request message<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11">(a) Access-Control-Request-Method<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1-12">This HF carries a list of methods indicating that ATTEST method
        will be used in the next request if the service can support it.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1-13">(b) Access-Control-Request-Headers<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">This HF carries a list of field names indicating that the AHFs will
        be included in the next request if the service can support them.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15">2. HFs in the response message<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">(a) Allow<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-16" class="pilcrow">¶</a></p>
<p id="section-3.1-17">This HF carries a list of supported methods by the visiting
        service. It must contain the ATTEST method for the client to proceed
        with AtR; otherwise, the AtR is not acceptable by this service and
        will be denied if received it.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-17" class="pilcrow">¶</a></p>
<p id="section-3.1-18">(b) Access-Control-Allow-Headers<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-18" class="pilcrow">¶</a></p>
<p id="section-3.1-19">This HF carries a list of allowed AHFs. The client needs to check
        that all of the requested AHFs should be contained in this resulting
        field.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-19" class="pilcrow">¶</a></p>
<p id="section-3.1-20">(c) Access-Control-Max-Age<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-20" class="pilcrow">¶</a></p>
<p id="section-3.1-21">This HF indicates how long the preflight check results can be
        cached.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.1-21" class="pilcrow">¶</a></p>
<p id="section-3.1-22"></p>
</section>
</div>
<div id="n-attest-handshake-aths-phase">
<section id="section-3.2">
        <h3 id="name-attest-handshake-aths-phase">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2" class="section-number selfRef">3.2. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-attest-handshake-aths-phase" class="section-name selfRef">Attest Handshake (AtHS) Phase</a>
        </h3>
<p id="section-3.2-1"></p>
<p id="section-3.2-2">The AtHS phase contains a core transaction of HTTPA/2. In a single
        round trip time (one RTT), the AtR and its response accomplish three
        major tasks, including key exchange, AtB allocation, and AtQ exchange,
        as shown in Figure 4.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-2" class="pilcrow">¶</a></p>
<span id="name-attest-handshake-aths-trans"></span><div id="ure-figure-4">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.2-3.1">
<pre>Client-side     Web Client            Web TService           Server-side
Verifier    (HW-TEE,Attester)      (HW-TEE,Attester)           Verifier
    |           |                   |                               |
    |           |                   |                               |
    |           | genExchangeKeys   | +==========ATTEST request========+
    |           |----+              | |Attest-Version: [versions]      |
    |           |    |              | |Attest-Date: [GMT]              |
    |           |&lt;---+              | |Attest-Signatures: sigs=[base64]|
    |           |                   | |Attest-Policies: [sec policies] |
    |   +=====OPTIONAL==========+   | |Attest-Base-Creation:[method]   |
    |   |       | genQuotes     |   | |Attest-Transport: [base64]      |
    |   |       |----+          |   | |Attest-Random: [base64]         |
    |   |       |    |          |   | |Attest-Quotes:quotes=[base64]   |
    |   |       |&lt;---+          |   | |            max-age=[expireTime]|
    |   +=======================+   | |Attest-Cipher-Suites:[ciphrName]|
    |           |                   | |Attest-Supported-Groups[grNames]|
    |           |                   | |Attest-Key-Shares: [shared keys]|
    |           | sendAttestRequest | |Attest-Blocklist:identifie=[ids]|
    |           |------------------&gt;| +================================+
    |           |                   |                               |
    |           |                +======IF ATTESTING MUTUALLY==========+
    |           |                |  |           sendQuote           |  |
    |           |                |  |------------------------------&gt;|  |
    |           |                |  |                               |  |
    |           |                |  |       getVerifyResult         |  |
    |           |                |  |&lt;------------------------------|  |
    |           |                +=====================================+
    |           |                   |-------+                       |
    |           |                   |       | allocAttestBase       |
    |           |                   |&lt;------+                       |
    |           |                   |-------+                       |
    |           |                   |       | genExchangeKeys       |
    |           |                   |&lt;------+                       |
    |           |                   |-------+                       |
    |           |                   |       | genQuotes             |
    |           |                   |&lt;------+                       |
    |           |                   |-------+                       |
    |           |                   |       | deriveKeys            |
    |           | getAttestResponse |&lt;------+                       |
    | sendQuote |&lt;------------------| +=========HTTP 200 OK============+
    |&lt;----------|                   | |Attest-Version: [selected ver]  |
    |  getVerif |                   | |Attest-Base-Id:[base64]         |
    |   Result  |                   | |            max-age=[expireTime]|
    |----------&gt;|                   | |Attest-Transport: [base64]      |
    | +=====status is not 200=====+ | |Attest-Random: [base64]         |
    | |=======or unverified=======| | |Attest-Expires: [GMT]           |
    | |         |----+            | | |Attest-Quotes:quotes=[base64]   |
    | |         |    | showErrors | | |            max-age=[expireTime]|
    | |         |&lt;---+            | | |Attest-Cipher-Suite:[ciphrNames]|
    | +===========================+ | |Attest-Supported-Group:[grNames]|
    |           |                   | |Attest-Key-Share: [shared key]  |
    |           |-------+           | |Attest-Secrets:[secrets="base64"|
    |           |       |deriveKeys | |            max-age=[expireTime]|
    |           |&lt;------+           | |Attest-Cargo: [base64]          |
    |           |                   | +================================+
    |           |                   |                               |
</pre>
</div>
<figcaption><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#figure-4" class="selfRef">Figure 4</a>:
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-attest-handshake-aths-trans" class="selfRef">Attest handshake (AtHS) transaction</a>
          </figcaption></figure>
</div>
<p id="section-3.2-4"></p>
<p id="section-3.2-5">1. Key Exchange<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">It is necessary to complete the key exchange process before any
        sensitive information can be transmitted between the client and
        TService. The exact steps within this will vary depending on the key
        exchange algorithm used and the cipher suites supported by both
        sides.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">In HTTPA/2, the key exchange process follows TLS 1.3 <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#RFC8446" class="cite xref">RFC8446</a>]</span> and
        recommends a set of key exchange methods to meet evolving needs for
        stronger security.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">Insecure cipher suites have been excluded; all public-key-based key
        exchange mechanisms now provide Perfect Forward Secrecy (PFS), e.g.,
        Ephemeral Elliptic Curve Diffie-Hellman (ECDHE). Note that it is
        mandatory that the fresh ephemeral keys are generated, used, and
        destroyed afterward <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#RFC8422" class="cite xref">RFC8422</a>]</span> inside the TEE of TService. When the key
        exchange is completed, we recommend using the HMAC-based Extract-
        and-Expand Key Derivation Function (HKDF) <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#RFC5869" class="cite xref">RFC5869</a>]</span> as an underlying
        primitive for key derivation. Also, note when a peer creates one or
        more (EC)DHE public keys, it must do so in a correct and
        standards-compliant manner. When a peer receives a set of (EC)DHE
        public keys, it must validate that the public key is in the specified
        group and has other required properties (e.g., it is not the group
        identity).<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">We describe the key negotiation between the client and the TService
        in terms of AHFs set in request and response, respectively, as
        follows:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-9" class="pilcrow">¶</a></p>
<p id="section-3.2-10">(a) AHFs in request message (or AtR):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-10" class="pilcrow">¶</a></p>
<p id="section-3.2-11">i. Attest-Cipher-Suites<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-11" class="pilcrow">¶</a></p>
<p id="section-3.2-12">It is a list of cipher suites that indicates the AEAD
        algorithm/HKDF supported by the client.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-12" class="pilcrow">¶</a></p>
<p id="section-3.2-13">ii. Attest-Supported-Groups<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-13" class="pilcrow">¶</a></p>
<p id="section-3.2-14">A list of named groups <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#RFC7748" class="cite xref">RFC7748</a>]</span> indicates the (EC)DHE groups
        supported by the client for key exchange, ordered from most preferred
        to least preferred.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-14" class="pilcrow">¶</a></p>
<p id="section-3.2-15">iii. Attest-Key-Shares<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-15" class="pilcrow">¶</a></p>
<p id="section-3.2-16">Its value contains a list of the client's cryptographic parameters
        for possible supported groups indicated in the AHL of
        Attest-Supported-Groups for negotiation. We can refer to the
        corresponding data structure described in TLS 1.3 <span>[<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#RFC8446" class="cite xref">RFC8446</a>]</span>. It is a
        time-consuming operation to generate those parameters.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-16" class="pilcrow">¶</a></p>
<p id="section-3.2-17"></p>
<p id="section-3.2-18">iv. Attest-Random<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-18" class="pilcrow">¶</a></p>
<p id="section-3.2-19">It is 32 bytes of a cryptographically random nonce, and the purpose
        of the random nonce is to bind the master secret and the keys to this
        particular handshake. This way mitigates the replay attack to the
        handshake as long as each peer properly generates this random
        nonce.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-19" class="pilcrow">¶</a></p>
<p id="section-3.2-20"></p>
<p id="section-3.2-21">(b) AHFs in response message<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-21" class="pilcrow">¶</a></p>
<p id="section-3.2-22">i. Attest-Cipher-Suite<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-22" class="pilcrow">¶</a></p>
<p id="section-3.2-23">It indicates the selected cipher suites, i.e., a symmetric
        cipher/HKDF hash pair for HTTPA/2 message protection.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-23" class="pilcrow">¶</a></p>
<p id="section-3.2-24">ii. Attest-Supported-Group<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-24" class="pilcrow">¶</a></p>
<p id="section-3.2-25">It indicates the selected named group to exchange ECDHE key share
        generated by the TService.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-25" class="pilcrow">¶</a></p>
<p id="section-3.2-26">iii. Attest-Key-Share<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-26" class="pilcrow">¶</a></p>
<p id="section-3.2-27">Its value contains the TService's cryptographic parameters
        accordingly.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-27" class="pilcrow">¶</a></p>
<p id="section-3.2-28">iv. Attest-Random<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-28" class="pilcrow">¶</a></p>
<p id="section-3.2-29">It takes the same mechanism as the Attest-Random in the request.
        Instead, it is used by the client to derive the master secret and
        other key materials.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-29" class="pilcrow">¶</a></p>
<p id="section-3.2-30"></p>
<p id="section-3.2-31">Note that anyone can observe this handshake process if the
        byte-to-byte encryption does not protect it at L5, but it is safe
        since the secrets of key exchange process will never be sent over the
        wire.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-31" class="pilcrow">¶</a></p>
<p id="section-3.2-32"></p>
<p id="section-3.2-33">2. AtB Allocation<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-33" class="pilcrow">¶</a></p>
<p id="section-3.2-34">This task is responsible for resource allocation. The upfront
        TService needs to prepare essential resources before assigning a
        unique AtB identifier to the AtB, which the client uses to ask
        TService to process its sensitive data on this AtB, AHF is part of
        AHL<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-34" class="pilcrow">¶</a></p>
<p id="section-3.2-35"></p>
<p id="section-3.2-36">(a) AHFs in request message (or AtR):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-36" class="pilcrow">¶</a></p>
<p id="section-3.2-37">i. Attest-Policies<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-37" class="pilcrow">¶</a></p>
<p id="section-3.2-38">It can contain various security policies, which this AtB of
        TService can selectively support. There are two aspects to consider as
        follows:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-38" class="pilcrow">¶</a></p>
<p id="section-3.2-39">
          <strong>Service instances attestation</strong><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-39" class="pilcrow">¶</a></p>
<p id="section-3.2-40">direct: all instances should be verified by the client.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-40" class="pilcrow">¶</a></p>
<p id="section-3.2-41">Indirect: only the contact instance(a proxy instance could be used
        for attesting other instances) should be verified by the client
        remotely.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-41" class="pilcrow">¶</a></p>
<p id="section-3.2-42">
          <strong>Un-trusted requests</strong><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-42" class="pilcrow">¶</a></p>
<p id="section-3.2-43">allowUntrustedReq: it allows UtR to be handled by the TService on
        this AtB (disabled by default).<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-43" class="pilcrow">¶</a></p>
<p id="section-3.2-44"></p>
<p id="section-3.2-45">ii. Attest-Base-Creation<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-45" class="pilcrow">¶</a></p>
<p id="section-3.2-46">It specifies a method used for the creation of AtB. There might be
        several options available to select:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-46" class="pilcrow">¶</a></p>
<p id="section-3.2-47"></p>
<p id="section-3.2-48">
          <strong>new</strong><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-48" class="pilcrow">¶</a></p>
<p id="section-3.2-49">It means that the AtB should be newly created for the client to
        use. If the contact TService is new, it can be assigned to this client
        immediately.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-49" class="pilcrow">¶</a></p>
<p id="section-3.2-50"></p>
<p id="section-3.2-51">
          <strong>reuse</strong><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-51" class="pilcrow">¶</a></p>
<p id="section-3.2-52">This option allows reusable AtB to be used by this client, but the
        AtB should ensure that all traces associated with the previous client
        are erased.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-52" class="pilcrow">¶</a></p>
<p id="section-3.2-53"></p>
<p id="section-3.2-54">So far, there is no such TEE, which can achieve this security
        feature strictly, and we cannot fully rely on software to emulate it.
        As a result, the client should evaluate the risks before specifying
        this option.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-54" class="pilcrow">¶</a></p>
<p id="section-3.2-55"></p>
<p id="section-3.2-56">
          <strong>shared</strong><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-56" class="pilcrow">¶</a></p>
<p id="section-3.2-57">A shareable AtB can be allocated to this client. The client doesn't
        care whether it is a clean base or not,so use it with caution.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-57" class="pilcrow">¶</a></p>
<p id="section-3.2-58">iii. Attest-Blocklist<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-58" class="pilcrow">¶</a></p>
<p id="section-3.2-59">It indicates a list of blocked identities and another type of
        identifier which allows TService to filter out unqualified AtB
        beforehand. This feature is used to optimize the performance of AtB
        allocation, as it is quite expensive and inefficient to rely only on
        the client to collect a set of TService instances by allow list using
        the trial and error method.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-59" class="pilcrow">¶</a></p>
<p id="section-3.2-60"></p>
<p id="section-3.2-61">(b) AHFs in response message:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-61" class="pilcrow">¶</a></p>
<p id="section-3.2-62">i. Attest-Base-ID<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-62" class="pilcrow">¶</a></p>
<p id="section-3.2-63">This identifier signifies the allocated AtB, which has been tied to
        this particular client who sent the AtHS request. It should be used in
        subsequent HTTPA/2 requests to ensure those requests can be
        efficiently dispatched into TServices. Given that the HTTPA/2 request
        dispatcher may not be trustworthy and be unable to check its
        integrity. As a result, it cannot guarantee that those requests could
        be delivered to their matched AtBs. To remedy this problem, the
        dispatcher should be capable of identifying as invalid AtB ID as
        possible, and the receiving TService should validate it right after
        the integrity check (see <code> REF _Ref107244144 \h \* MERGEFORMAT
        Figure 5</code> and <code> REF _Ref107244151 \h \* MERGEFORMAT Figure
        6</code>).<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-63" class="pilcrow">¶</a></p>
<p id="section-3.2-64"></p>
<p id="section-3.2-65">Note that the max-age directive set here indicates how long this
        AtB could be kept alive at the server-side, it follows GMT, and the
        unit is second.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-65" class="pilcrow">¶</a></p>
<p id="section-3.2-66"></p>
<p id="section-3.2-67">3. AtQ Exchange<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-67" class="pilcrow">¶</a></p>
<p id="section-3.2-68">In HTTPA/2, a successful RA increases the client's confidence by
        assuring the targeting services are running inside a trustworthy AtB.
        The client can also determine the level of trust in the security
        assurances provided by TServices through AtB.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-68" class="pilcrow">¶</a></p>
<p id="section-3.2-69">The RA is mainly aimed at provision secrets to a TEE. In this
        solution, we leverage this mechanism to set it as the root trust of
        the HTTPA/2 transactions instead of certificate-based trust, e.g.,
        TLS. To facilitate it, we integrate the RA with the key exchange
        mechanism above to perform a handshake, which passes the assurance to
        derive ephemeral key materials. Those keys can be, in turn, used to
        protect secrets and sensitive data designated by the client or
        TService on either direction.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-69" class="pilcrow">¶</a></p>
<p id="section-3.2-70">During the RA process, the AtQ plays a key role in attesting
        TService. It provides evidence (quote) to prove the authenticity of
        the relevant TService and provides assurance that the TService is a
        trustworthy client can just rely on it to decide whether the TService
        is a trustworthy peer or not.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-70" class="pilcrow">¶</a></p>
<p id="section-3.2-71">To appraise AtQ, we need a trusted authority to be the verifier to
        perform the process of AtQ verification and report issues on this AtQ,
        e.g., TCB issues. The verification result produced by the verifier
        should be further assessed by the client according to its
        pre-configured policy rules and applied security contexts. Notably,
        the TService should ensure the integrity and authenticity of all AHLs
        of AtR, and its response through a piece of user-defined information,
        called Quote User Defined Data (QUDD) of AtQ, the QUDD can provide
        extra identities specific to a TService. Therefore, the AtQ can, in
        turn, help protect the integrity of Attest Header Lines (AHLs). The
        following AHFs should be supported by HTTPA/2 protocol for RA request
        message is optional.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-71" class="pilcrow">¶</a></p>
<p id="section-3.2-72">(a) AHFs in request message (or AtR):<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-72" class="pilcrow">¶</a></p>
<p id="section-3.2-73">i. Attest-Quotes<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-73" class="pilcrow">¶</a></p>
<p id="section-3.2-74">It can only appear in mHTTPA/2 mode to indicate a set of AtQs
        generated from the TClients for targeting TService to verify. These
        quotes should be used to ensure IntAuth of the AHLs of this AtR
        through their QUDD.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-74" class="pilcrow">¶</a></p>
<p id="section-3.2-75">Note that the max-age directive indicates when these quotes are
        outdated, and its cached verification results should be cleared up
        from AtB to avoid broken assurance. In addition, all client-side
        quotes must be verified by the server-side verifier and validated by
        TServices before an AtB ID can be issued.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-75" class="pilcrow">¶</a></p>
<p id="section-3.2-76"></p>
<p id="section-3.2-77">(b) AHFs in response message<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-77" class="pilcrow">¶</a></p>
<p id="section-3.2-78">i. Attest-Quotes<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-78" class="pilcrow">¶</a></p>
<p id="section-3.2-79">An AtB must present its AtQs to the client for client-side
        verification. The IntAuth of both AHLs of the AtR and its response
        should be ensured by its QUDDs to protect the transaction
        completely.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-79" class="pilcrow">¶</a></p>
<p id="section-3.2-80">The client must verify the AtQ to authenticate its identity of
        remote AtB. The client should not trust anything received from
        TService before AtQs are successfully verified and evaluated by the
        trust authority. Whether the integrity of AHLs is held should be
        determined by client-side security policies. Note that the TService
        quotes can be selectively encrypted in its parts through TrC to hide
        their identity information.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-80" class="pilcrow">¶</a></p>
<p id="section-3.2-81">There are several remaining AHFs, which are important to this
        transaction as they provide other necessary information and useful
        security properties:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-81" class="pilcrow">¶</a></p>
<p id="section-3.2-82"></p>
<p id="section-3.2-83">(a) AHFs in the request message<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-83" class="pilcrow">¶</a></p>
<p id="section-3.2-84">i. Attest-Versions<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-84" class="pilcrow">¶</a></p>
<p id="section-3.2-85">The client presents an ordered list of supported versions of HTTPA
        to negotiate with its targeting TService.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-85" class="pilcrow">¶</a></p>
<p id="section-3.2-86">ii. Attest-Date<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-86" class="pilcrow">¶</a></p>
<p id="section-3.2-87">It is the Coordinated Universal Time (UTC) when the client
        initiates a AtHS.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-87" class="pilcrow">¶</a></p>
<p id="section-3.2-88">iii. Attest-Signatures<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-88" class="pilcrow">¶</a></p>
<p id="section-3.2-89">It contains a set of signatures, which are used to ensure IntAuth
        of AHLs in this AtR through client-side signing key?<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-89" class="pilcrow">¶</a></p>
<p id="section-3.2-90">iv. Attest-Transport<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-90" class="pilcrow">¶</a></p>
<p id="section-3.2-91">With this, the TService can enforce a trustworthy and secure
        connection at L5, which is a bit similar to what HTTP Strict Transport
        Security (HSTS) does.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-91" class="pilcrow">¶</a></p>
<p id="section-3.2-92"></p>
<p id="section-3.2-93">(b) AHFs in response message<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-93" class="pilcrow">¶</a></p>
<p id="section-3.2-94">i. Attest-Version<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-94" class="pilcrow">¶</a></p>
<p id="section-3.2-95">It shows the client which version of HTTPA is selected by TService
        to support, server has to apply in this selection process<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-95" class="pilcrow">¶</a></p>
<p id="section-3.2-96">ii. Attest-Transport<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-96" class="pilcrow">¶</a></p>
<p id="section-3.2-97">Similarly, the TService returns its HELLO message to the client for
        a secure transport layer handshake.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-97" class="pilcrow">¶</a></p>
<p id="section-3.2-98">iii. Attest-Expires<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-98" class="pilcrow">¶</a></p>
<p id="section-3.2-99">It indicates when the allocated AtB will expire, and when its
        related resources will be released. It provides another layer of
        security to help reduce the possibility of this AtB being successfully
        attacked.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-99" class="pilcrow">¶</a></p>
<p id="section-3.2-100">iv. Attest-Secrets<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-100" class="pilcrow">¶</a></p>
<p id="section-3.2-101">It is an ordered list of AtB-wide secrets, which TService
        provisions if the client expects them. This way can save a round trip
        time of AtSP in case the TService won't demand secrets from the client
        immediately.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-101" class="pilcrow">¶</a></p>
<p id="section-3.2-102">v.Attest-Cargo<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-102" class="pilcrow">¶</a></p>
<p id="section-3.2-103">It is used to carry any sensitive information which 14is meaningful
        to TService. Note that "Attest-Cargo" is an AHF while TrC is the
        corresponding content which plays an important role in sensitive data
        encryption and authentication.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-103" class="pilcrow">¶</a></p>
<p id="section-3.2-104"></p>
<p id="section-3.2-105">Apart from those tasks above, this AtR can act as a GET request,
        but it cannot be trusted due to incomplete key exchange at this
        moment, which means it cannot contain any sensitive data, but its
        response can be trusted as the key exchange process completed at
        TService-side, and before it gets returned. Therefore, the
        TService-side sensitive data can be safely transmitted back to the
        client through the TrC.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.2-105" class="pilcrow">¶</a></p>
<p id="section-3.2-106"></p>
</section>
</div>
<div id="n-attest-secret-provisioning-atsp-phase">
<section id="section-3.3">
        <h3 id="name-attest-secret-provisioning-">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3" class="section-number selfRef">3.3. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-attest-secret-provisioning-" class="section-name selfRef">Attest Secret Provisioning (AtSP) Phase</a>
        </h3>
<p id="section-3.3-1"></p>
<p id="section-3.3-2">The main purpose of AtSP is to securely deliver secrets to a
        trustworthy AtB, which a server-side verifier has verified. The AtR of
        AtSP is intended to be used for this purpose. To be precise, it is for
        AtB-wide and client-wide secret provisioning. On the contrary, the
        request-wide or response-wide secrets should be carried by the TrCs of
        HTTPA/2 transactions. In addition, the failure of AtSP will cause AtB
        termination immediately.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">As shown in Figure 5,
        the AtSP transaction can be used to provision secrets in two
        directions since the AtB and its key materials have already been
        derived through AtHS on both sides; thus, the AHLs can be better
        protected during this phase. Moreover, AtR of AtSP can be issued by
        the client any number of times at any time after AtHS.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-3" class="pilcrow">¶</a></p>
<span id="name-attest-secret-provisioning-a"></span><div id="ure-figure-5">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-3.3-4.1">
<pre>+----------------------------------------------------------------------+
|Client-side  Web Client         Web TService               Server-side|
|Verifier   (HW-TEE,Attester)   HW-TEE,Attester)               Verifier|
|   |         |                     |                              |   |
|   |         |  sendSecretRequest  |                              |   |
|   |         |--------------------&gt;|                              |   |
|   |         |                     | +==========ATTEST request=======+|
|   |         |                     | |Attest-Base-Id: [base64]       ||
|   |         |                     | |Attest-Ticket: [base64]        ||
|   |         |                     | |Attest-Secrets:                ||
|   |         |                     | |           [secrets="base64";  ||
|   |         |                     | |            max-age=expireTime]||
|   |         |                     | |Attest-Cargo: [base64]         ||
|   |         |                     | +===============================+|
|   |         |                     |                              |   |
|   |         |                     |-------+                      |   |
|   |         |                     |       | validateBase         |   |
|   |         |                     |&lt;------+                      |   |
|   |         |                     |                              |   |
|   |         |                     |-------+                      |   |
|   |         |                     |       | validateSecrets      |   |
|   |         |                     |&lt;------+                      |   |
|   |         |                     | +=========ATTEST response=======+|
|   |         |                     | |Attest-Binder: [base64]        ||
|   |         |                     | |Attest-Secrets:                ||
|   |         |                     | |           [secrets="base64";  ||
|   |         |                     | |            max-age=expireTime]||
|   |         |                     | |Attest-Cargo: [base64]         ||
|   |         |                     | +===============================+|
|   |         |                     |                              |   |
|   |         |  getAttestResponse  |                              |   |
|   |         |&lt;--------------------|                              |   |
|   |       +==status is not 200==+ |                              |   |
|   |       | |----+              | |                              |   |
|   |       | |    | showErrors   | |                              |   |
|   |       | |&lt;---+              | |                              |   |
|   |       +=====================+ |                              |   |
|   |         |                     |                              |   |
+----------------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#figure-5" class="selfRef">Figure 5</a>:
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-attest-secret-provisioning-a" class="selfRef">Attest secret provisioning (AtSP) transaction</a>
          </figcaption></figure>
</div>
<p id="section-3.3-5">These AHLs are described in the following:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">1. AHFs in request message (or AtR)<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">(a) Attest-Base-ID<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">This identifier is used to specify which AtB is targeted to handle
        this AtR of AtSP. With this ID, the TService can validate it against
        its serving list to ensure this request is correctly handled. However,
        the TService should quietly ignore it if the ID is not valid for its
        residing AtB as the receiving TService should not expose any
        information for an adversary to exploit.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-8" class="pilcrow">¶</a></p>
<p id="section-3.3-9">(b) Attest-Ticket<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-9" class="pilcrow">¶</a></p>
<p id="section-3.3-10">AtT is a type of AHL used to ensure the integrity and authenticity
        (IntAuth) of AHLs and freshness by applying AAD to each HTTPA/2
        request, except for the AtR of AtHS, which is the initiating request
        for the handshake. The value of this field must be unique to previous
        values to prevent replay attacks. Also, it ensures the IntAuth of the
        AHLs in this request.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3-11">(c) Attest-Secrets<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-11" class="pilcrow">¶</a></p>
<p id="section-3.3-12">It contains an ordered list of secrets, which is wrapped up using
        AE as a standard way for strong protection. Moreover, each secret
        should be able to be referred to by the client later using the index.
        For example, specifying a provisioned secret that is used to decrypt
        embedded sensitive data. Again, the receiving AtB should be terminated
        if any of these provisioned secrets cannot be validated or accepted by
        the AtB.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-12" class="pilcrow">¶</a></p>
<p id="section-3.3-13">(d) Attest-Cargo<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-13" class="pilcrow">¶</a></p>
<p id="section-3.3-14">This field is optional, it can be used to carry any sensitive
        information which is meaningful to TService. Note that this paper is
        not intended to define the structure of its content, which could be
        addressed in another one.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-14" class="pilcrow">¶</a></p>
<p id="section-3.3-15"></p>
<p id="section-3.3-16">2. AHFs in response message:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-16" class="pilcrow">¶</a></p>
<p id="section-3.3-17">(a) Attest-Binder<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-17" class="pilcrow">¶</a></p>
<p id="section-3.3-18">It is used to make sure the response request is binding and
        uniquely identifies this transaction.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-18" class="pilcrow">¶</a></p>
<p id="section-3.3-19">(b) Attest-Secrets<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-19" class="pilcrow">¶</a></p>
<p id="section-3.3-20">In this HF, these contained wrapped secrets will be provisioned
        back to the client. As noted earlier, this can be merged into the
        response AHLs in AtR of AtHS.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-20" class="pilcrow">¶</a></p>
<p id="section-3.3-21">(c) Attest-Cargo<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-21" class="pilcrow">¶</a></p>
<p id="section-3.3-22">Similarly, it can be used to carry sensitive information/data back
        to the client.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.3-22" class="pilcrow">¶</a></p>
<p id="section-3.3-23"></p>
<p id="section-3.3-24"></p>
</section>
</div>
<div id="n-trusted-phase-communication">
<section id="section-3.4">
        <h3 id="name-trusted-phase-communication">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4" class="section-number selfRef">3.4. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-trusted-phase-communication" class="section-name selfRef">Trusted Phase Communication</a>
        </h3>
<p id="section-3.4-1"></p>
<p id="section-3.4-2">When AtB is allocated for the client, it can subsequently issue to
        do the real work. Basically, the TrR is an ordinary HTTP request with
        some extra AHLs, which are described in detail as follows:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">1. AHFs in request message:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">(a) Attest-Base-ID<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">It specifies which AtB to handle this request and should be
        validated by targeting TService before processing this request.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4-6">(b) Attest-Ticket<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4-7">This field has been explained above, which is intended to
        authenticate this request and prevent other AHLs from being tampered
        with or being replayed.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">(c) Attest-Cargo<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4-9">As noted earlier, this field is optional, and the client can use it
        to transfer arbitrary sensitive information to TService.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-9" class="pilcrow">¶</a></p>
<p id="section-3.4-10">(d) Attest-Base-Termination<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-10" class="pilcrow">¶</a></p>
<p id="section-3.4-11"></p>
<p id="section-3.4-12">We can include this AHF if it is the last TrR towards the AtB. It
        is recommended way to terminate a AtB actively. If the server never
        receives this header field in a request, attest base will eventually
        expire, which is specified in the Attest-Expires.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-12" class="pilcrow">¶</a></p>
<p id="section-3.4-13">The termination method can be one of the following options:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-13" class="pilcrow">¶</a></p>
<p id="section-3.4-14">
          <strong>cleanup</strong><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-14" class="pilcrow">¶</a></p>
<p id="section-3.4-15">This means that other clients can reuse the terminated AtB.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-15" class="pilcrow">¶</a></p>
<p id="section-3.4-16">
          <strong>destroy</strong><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-16" class="pilcrow">¶</a></p>
<p id="section-3.4-17">Specify this method if the AtB should not be reused or shared by
        any other clients.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-17" class="pilcrow">¶</a></p>
<p id="section-3.4-18">
          <strong>keep</strong><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-18" class="pilcrow">¶</a></p>
<p id="section-3.4-19">This allows AtB to be shared with other clients. Be careful that
        this method is less safe as the residual data could be exploited and
        leaked to the next client if any.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-19" class="pilcrow">¶</a></p>
<p id="section-3.4-20"></p>
<p id="section-3.4-21">2. AHFs in response message:<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-21" class="pilcrow">¶</a></p>
<p id="section-3.4-22">(a) Attest-Binder<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-22" class="pilcrow">¶</a></p>
<p id="section-3.4-23">As explained earlier, the HTTPA/2 uses it to ensure the IntAuth of
        both request and response.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-23" class="pilcrow">¶</a></p>
<p id="section-3.4-24">(b) Attest-Cargo<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-24" class="pilcrow">¶</a></p>
<p id="section-3.4-25">As noted earlier, the TService can leverage this mechanism to
        transfer arbitrary sensitive information back to its client.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.4-25" class="pilcrow">¶</a></p>
<span id="name-trusted-transaction"></span><div id="ure-figure-6">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-3.4-26.1">
<pre>Client-side   Web Client           Web TService              Server-side
Verifier   (HW-TEE,Attester)    (HW-TEE,Attester)              Verifier
    |         |                     |                               |
    |         |  sendRequest        |                               |
    |         |--------------------&gt;|                               |
    |         |                     | +==========HTTP request==========+
    |         |                     | |Attest-Base-Id: [base64]        |
    |         |                     | |Attest-Ticket: [base64]         |
    |         |                     | |Attest-Cargo: [base64]          |
    |         |                     | |Attest-Base-Termination:[method]|
    |         |                     | +================================+
    |         |                     |                               |
    |         |                     |-------+                       |
    |         |                     |       | validateBase          |
    |         |                     |&lt;------+                       |
    |         |                     |                               |
    |  +============================SUCCESS======================+  |
    |  |      |                     |                            |  |
    |  |      |                     |-------+                    |  |
    |  |      |                     |       | handleRequest      |  |
    |  |      |                     |&lt;------+                    |  |
    |  |      |                     |                            |  |
    |  |      |                     | +========HTTP 200 OK=====+ |  |
    |  |      |                     | |Attest-Binder: [base64] | |  |
    |  |      |                     | |Attest-Cargo: [base64]  | |  |
    |  |      |                     | +========================+ |  |
    |  |      |  TService response  |                            |  |
    |  |      |&lt;--------------------|                            |  |
    |  +=========================================================+  |
    |         |                     |                               |
    |  +===============FAILURE=========+                            |
    |  |      |                     |  |                            |
    |  |      |       HTTP_503      |  |                            |
    |  |      | Service_Unavailable |  |                            |
    |  |      |&lt;--------------------|  |                            |
    |  |      |                     |  |                            |
    |  |      |----+                |  |                            |
    |  |      |    | showErrors     |  |                            |
    |  |      |&lt;---+                |  |                            |
    |  +===============================+                            |
    |         |                     |                               |
</pre>
</div>
<figcaption><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#figure-6" class="selfRef">Figure 6</a>:
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-trusted-transaction" class="selfRef">Trusted transaction</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="n-changes-in-mutual-httpa2mhttpa">
<section id="section-3.5">
        <h3 id="name-changes-in-mutual-httpa-2mh">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.5" class="section-number selfRef">3.5. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-changes-in-mutual-httpa-2mh" class="section-name selfRef">Changes in Mutual HTTPA/2(mHTTPA)</a>
        </h3>
<p id="section-3.5-1"></p>
<p id="section-3.5-2">With mutual HTTPA being used, the client must be running on a TEE
        as TEE-based client (TClient), which can generate a client-side AtQ.
        The AtQ can be used to ensure the IntAuth of AtR by means of including
        the digest of AHLs into its QUDD, and the server-side should have a
        proper trusted attestation authority to verify it.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">This is the recommended approach to build mutual trust between
        TClient and TService, but the client-side usually lacks TEE feature
        support.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4"></p>
</section>
</div>
</section>
</div>
<div id="n-security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4" class="section-number selfRef">4. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1"></p>
<div id="n-layer-7-endtoend-protection">
<section id="section-4.1">
        <h3 id="name-layer-7-end-to-end-protecti">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.1" class="section-number selfRef">4.1. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-layer-7-end-to-end-protecti" class="section-name selfRef">Layer 7 End-to-End Protection</a>
        </h3>
<p id="section-4.1-1"></p>
<p id="section-4.1-2">In cloud computing scenarios, intermediary nodes, such as L7 load
        balancer or reverse proxy, are commonly used to improve the network
        performance to deliver the best web experience. The secure
        communication based on TLS only protects transmitted data hop-by-hop
        at layer 5 (L5). The intermediary nodes<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">may need TLS termination to inspect HTTP messages in plain text for
        better network performance. Consequently, the intermediary nodes can
        read and modify any HTTP information at L7. It is the gap between L5
        and L7 that may cause an underlying vulnerability. Therefore, the
        trust model, including intermediary nodes, which are over L5, is
        problematic because intermediary nodes are not necessarily
        trustworthy. Intermediary nodes may leak the privacy and manipulate
        the header lines of HTTP messages. Even in the case where
        intermediaries are fully trusted, an attacker may exploit the
        vulnerability of the hop-by-hop architecture which may lead to data
        breaches. HTTPA/2 helps protect AHLs and the sensitive information of
        HTTP messages end-to-end at L7. As long as the protection does not
        encrypt the necessary information against proxy operations, HTTPA/2
        can help provide guarantees that the protected message can survive
        across middleboxes to reach the endpoint. Thus, the parts of HTTPA
        information without protection may be exploited to spoof or
        manipulate. If we want to protect every bit of HTTPA message
        hop-by-hop, TLS is highly recommended in combination with HTTPA/2<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">for use.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">In the implementation, the TServices can make a privacy policy to
        determine to what degree the HTTPA message is protected to the L7
        endpoint without TLS for better network performance. If the message is
        highly sensitive, entirely<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">TLS can come to help in addition, but only up to the security of
        the L5 hop point.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7"></p>
</section>
</div>
<div id="n-replay-protection">
<section id="section-4.2">
        <h3 id="name-replay-protection">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.2" class="section-number selfRef">4.2. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-replay-protection" class="section-name selfRef">Replay Protection</a>
        </h3>
<p id="section-4.2-1"></p>
<p id="section-4.2-2">A replay attack should be considered in terms of design and
        implementation. To mitigate replay attack, most AEAD algorithms
        require a unique nonce for each message. In AtR, random numbers are
        used. In TrR, a sequential nonce is used on either endpoint
        accordingly. Assuming strictly increasing number in sequence, the
        replay attack can be easily detected if any received number is
        duplicated or no larger than the previously received number. For
        reliable transport, the policy can be made to accept only TrR with a
        nonce that is equal to the previous number plus one.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3"></p>
</section>
</div>
<div id="n-downgrade-protection">
<section id="section-4.3">
        <h3 id="name-downgrade-protection">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.3" class="section-number selfRef">4.3. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-downgrade-protection" class="section-name selfRef">Downgrade Protection</a>
        </h3>
<p id="section-4.3-1"></p>
<p id="section-4.3-2">The cryptographic parameters of configuration should be the same
        for both parties as if there is no presence of an attacker between
        them. We should always negotiate the preferred common parameters with
        the peer. If the negotiated parameters of configuration are different
        for both parties, it could make peers use a weaker cryptographic mode
        than the one they should use, thus leading to potentially a downgrade
        attack. In HTTPA/2, TService uses AtQ to authenticate its identity and
        the integrity of the AtHS to the client. In mutual HTTPA/2, the client
        uses AtQ carried by AtR for proving its own authenticity and the
        message integrity. Thus, the communication traffic of the handshake
        across intermediaries cannot be compromised by attackers.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3"></p>
</section>
</div>
<div id="n-privacy-considerations">
<section id="section-4.4">
        <h3 id="name-privacy-considerations">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.4" class="section-number selfRef">4.4. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-4.4-1"></p>
<p id="section-4.4-2">Privacy threats are considerably reduced by means of HTTPA/2 across
        intermediary nodes. End-to-end access restriction of integrity and
        encryption on the HTTPA/2 AHLs and payloads, which are not used to
        block proxy operations, aids in mitigating attacks to the
        communication between the client and the TService. On the other hand,
        the unprotected part of HTTP headers and payloads, which is also
        intended to be, may reveal information related to the sensitive and
        protected parts. Then private dat may be exposed. For example, the
        HTTP message fields visible to on-path entities are only used for the
        purpose of transporting the message to the end- point, whereas the
        AHLs and its binding pay- loads are encrypted or signed. It is
        possible for attackers to exploit the visible parts of HTTP messages
        to infer the encrypted information if the privacy preserving policy is
        not well set up. Unprotected error messages can reveal information of
        the security state in the communication between the endpoints.
        Unprotected signaling messages can reveal information of the reliable
        transport. The length of HTTPA/2 message fields can re- veal
        information about the message. TService may use a padding scheme to
        protect against traffic analysis. After all, HTTPA/2 provides a new
        dimension for applications to further protect privacy.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3"></p>
</section>
</div>
<div id="n-roots-of-trust-rot">
<section id="section-4.5">
        <h3 id="name-roots-of-trust-rot">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.5" class="section-number selfRef">4.5. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-roots-of-trust-rot" class="section-name selfRef">Roots of Trust (RoT)</a>
        </h3>
<p id="section-4.5-1"></p>
<p id="section-4.5-2">Many security mechanisms are currently rooted in software; however,
        we have to trust underlying components, including software, firmware,
        and hardware. A vulnerability of the components could be easily
        exploited to compromise the security mechanisms when the RoT is
        broken. One way to reduce that risk of vulnerability is to choose a
        highly reliable RoT. RoT consists of trusted hardware, firmware, and
        software components that perform specific, critical security
        functions. RoT is supposed to be trusted and more secure, so it is
        usually used to pro- vide strong assurances for the desired security
        properties. In HTTPA/2, the inherent RoT is the AtB or TEEs, which
        provide a firm foundation to build security and trust. With AtB being
        used in HTTPA/2, we believe that the risks of security and privacy can
        be greatly reduced.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3"></p>
</section>
</div>
</section>
</div>
<div id="n-acknowledgements">
<section id="section-5">
      <h2 id="name-acknowledgements">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-5" class="section-number selfRef">5. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-5-1"></p>
<p id="section-5-2">We would like to acknowledge the support from the HTTPA workgroup
      members, including our partners and reviewers. We thank them for their
      valuable feedback and suggestions.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3"></p>
</section>
</div>
<div id="n-iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-6" class="section-number selfRef">6. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1"></p>
<p id="section-6-2">This document has no IANA actions.<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3"></p>
<p id="section-6-4"></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-7" class="section-number selfRef">7. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-7.1" class="section-number selfRef">7.1. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="SEMANTICS">[SEMANTICS]</dt>
      <dd>
<span class="refAuthor">Fielding, R. T.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">J. Reschke</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-semantics-19</span>, <time datetime="2021-09-12" class="refDate">12 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-semantics-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#section-7.2" class="section-number selfRef">7.2. </a><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D-1">[I-D-1]</dt>
        <dd>
<span class="refAuthor">Backman, A.</span>, <span class="refAuthor">Richer, J.</span>, and <span class="refAuthor">M. Sporny</span>, <span class="refTitle">"HTTP Message Signatures draft-ietfhttpbis-message-signatures-08"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, IETF</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-httpbis-message-signatures-08.html">https://www.ietf.org/archive/id/draft-ietf-httpbis-message-signatures-08.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-10">[I-D-10]</dt>
        <dd>
<span class="refAuthor">Anati, Ittai.</span>, <span class="refAuthor">Gueron, Shay.</span>, <span class="refAuthor">Johnson, Simon P.</span>, and <span class="refAuthor">Vincent R. Scarlata</span>, <span class="refTitle">"Innovative Technology for CPU Based Attestation and Sealing"</span>, <span>&lt;<a href="https://www.intel.com/content/dam/develop/external/us/en/documents/hasp-2013-innovative-technology-for-attestation-and-sealing.pdf">https://www.intel.com/content/dam/develop/external/us/en/documents/hasp-2013-innovative-technology-for-attestation-and-sealing.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-11">[I-D-11]</dt>
        <dd>
<span class="refAuthor">King, Gordon.</span> and <span class="refAuthor">Hans. Wang</span>, <span class="refTitle">"HTTPA: HTTPS Attestable Protocol"</span>, <span class="seriesInfo">DOI 10.48550/ARXIV.2110.07954</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://arxiv.org/abs/2110.07954">https://arxiv.org/abs/2110.07954</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-13">[I-D-13]</dt>
        <dd>
<span class="refAuthor">Krawczyk, Hugo.</span>, <span class="refTitle">"SIGMA: The 'SIGn-andMAc' Approach to Authenticated DiffieHellman and Its Use in the IKE Protocols. In: Advances in Cryptology - CRYPTO 2003. Ed. by Dan Boneh. Berlin, Heidelberg: Springer Berlin Heidelberg pp. 400-425"</span>, <span class="seriesInfo">ISBN 978-3-540-45146-4</span>, <time datetime="2003" class="refDate">2003</time>. </dd>
<dd class="break"></dd>
<dt id="I-D-16">[I-D-16]</dt>
        <dd>
<span class="refAuthor">Ménétrey et al., Jämes.</span>, <span class="refTitle">"An Exploratory Study of Attestation Mechanisms for Trusted Execution Environments"</span>, <span class="seriesInfo">DOI 10.48550/ARXIV.2204.06790</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://arxiv.org/abs/2204.06790">https://arxiv.org/abs/2204.06790</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-19">[I-D-19]</dt>
        <dd>
<span class="refTitle">"Remote Attestation"</span>, <span>&lt;<a href="https://www.intel.com/content/www/us/en/developer/tools/software-guard-extensions/attestation-services.html">https://www.intel.com/content/www/us/en/developer/tools/software-guard-extensions/attestation-services.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-2">[I-D-2]</dt>
        <dd>
<span class="refAuthor">Banks, Alexander Sprogø.</span>, <span class="refAuthor">Kisiel, Marek.</span>, and <span class="refAuthor">Philip. Korsholm</span>, <span class="refTitle">"Remote Attestation: A Literature Review. In: CoRRabs/2105.02466 (2021). arXiv: 2105.02466."</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://arxiv.org/abs/2105.02466">https://arxiv.org/abs/2105.02466</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-21">[I-D-21]</dt>
        <dd>
<span class="refAuthor">Regenscheid, Andrew.</span>, <span class="refTitle">"Roots of Trust (RoT)"</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://csrc.nist.gov/Projects/Hardware-Roots-of-Trust">https://csrc.nist.gov/Projects/Hardware-Roots-of-Trust</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-3">[I-D-3]</dt>
        <dd>
<span class="refAuthor">Bhargavan et al, Karthikeyan.</span>, <span class="refTitle">"Downgrade resilience in key-exchange protocols. In: 2016 IEEE Symposium on Security and Privacy (SP)"</span>, <span class="seriesInfo">IEEE pp. 506-525</span>, <time datetime="2016" class="refDate">2016</time>. </dd>
<dd class="break"></dd>
<dt id="I-D-4">[I-D-4]</dt>
        <dd>
<span class="refAuthor">Birkholz et al, H.</span>, <span class="refTitle">"Remote Attestation Procedures Architecture draftietf-rats-architecture-12"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, IETF</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-rats-architecture-12.html">https://www.ietf.org/archive/id/draft-ietf-rats-architecture-12.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-5">[I-D-5]</dt>
        <dd>
<span class="refAuthor">Marinescu, Dan C.</span>, <span class="refTitle">"Execution Environments"</span>, <span>&lt;<a href="https://www.sciencedirect.com/topics/computer-science/execution-environments">https://www.sciencedirect.com/topics/computer-science/execution-environments</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D-8">[I-D-8]</dt>
        <dd>
<span class="refAuthor">Helble et al., Sarah C.</span>, <span class="refTitle">"Flexible Mechanisms for Remote Attestation”. In: ACM Trans. Priv. Secur. 24.4"</span>, <span class="seriesInfo">ISSN 2471-2566</span>, <span class="seriesInfo">DOI 10.1145/3470535</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://doi.org/10.1145/3470535">https://doi.org/10.1145/3470535</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, David.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5116">https://www.rfc-editor.org/info/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, Dr. Hugo.</span> and <span class="refAuthor">Pasi. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6797">[RFC6797]</dt>
        <dd>
<span class="refAuthor">Hodges, Jeff.</span>, <span class="refAuthor">Jackson, Collin.</span>, and <span class="refAuthor">Adam. Barth</span>, <span class="refTitle">"HTTP Strict Transport Security (HSTS)"</span>, <span class="seriesInfo">RFC 6797</span>, <span class="seriesInfo">DOI 10.17487/RFC6797</span>, <time datetime="2012-11" class="refDate">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6797">https://www.rfc-editor.org/info/rfc6797</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
        <dd>
<span class="refAuthor">Fielding, Roy T.</span> and <span class="refAuthor">Julian. Reschke</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7231">[RFC7231]</dt>
        <dd>
<span class="refAuthor">Fielding, Roy T.</span> and <span class="refAuthor">Julian. Reschke</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, Adam.</span>, <span class="refAuthor">Hamburg, Mike.</span>, and <span class="refAuthor">Sean. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8422">[RFC8422]</dt>
        <dd>
<span class="refAuthor">Nir, Yoav.</span>, <span class="refAuthor">Josefsson, Simon.</span>, and <span class="refAuthor">Manuel. Pégourié-Gonnard</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier"</span>, <span class="seriesInfo">RFC 8422</span>, <span class="seriesInfo">DOI 10.17487/RFC8422</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8422">https://www.rfc-editor.org/info/rfc8422</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, Eric.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander et al., Göran.</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8813</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfceditor.org/info/rfc8613">https://www.rfceditor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8941">[RFC8941]</dt>
      <dd>
<span class="refAuthor">Nottingham, Mark.</span> and <span class="refAuthor">Poul-Henning. Kamp</span>, <span class="refTitle">"Structured Field Values for HTTP"</span>, <span class="seriesInfo">RFC 8941</span>, <span class="seriesInfo">DOI 10.17487/RFC8941</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8941">https://www.rfc-editor.org/info/rfc8941</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="n-authors">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<div class="alignLeft art-text artwork" id="appendix-A-1">
<pre>Shih-han Wang
Intel Corporation
US
Email: hans.wang@intel.com

Gordon King
Intel Corporation
US
Email: gordon.king@intel.com

Nick Li
Intel Corporation
US
Email: nick.li@intel.com

Ned Smith
Intel Corporation
US
Email: ned.smith@intel.com

Krzysztof Sandowicz
Intel Corporation
PL
Email: krzysztof.sandowicz@intel.com Phone: +48587661619
</pre><a href="https://www.ietf.org/archive/id/draft-sandowicz-httpbis-httpa2-03.html#appendix-A-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>